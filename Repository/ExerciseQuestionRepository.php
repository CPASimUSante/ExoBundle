<?php

namespace UJM\ExoBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * ExerciseQuestionRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class ExerciseQuestionRepository extends EntityRepository
{
    /**
     * Exercises use the question
     *
     * @access public
     *
     * @param integer $questionId id Question
     *
     * Return array[ExerciseQuestion]
     */
    public function getExercises($questionId)
    {
        $qb = $this->createQueryBuilder('eq');
        $qb->join('eq.question', 'q')
            ->where($qb->expr()->in('q.id', $questionId));

        return $qb->getQuery()->getResult();
    }

    /**
     * Number of question for an exercise
     *
     * @access public
     *
     * @param integer $exoId if Exercise
     *
     * Return aintger
     */
    public function getCountQuestion($exoId)
    {
        $dql = 'SELECT count(eq.question) as nbq
                FROM UJM\ExoBundle\Entity\ExerciseQuestion eq
                WHERE eq.exercise='.$exoId;

        $query = $this->_em->createQuery($dql);

        return $query->getSingleResult();
    }
}